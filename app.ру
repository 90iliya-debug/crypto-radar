import streamlit as st
import requests
import pandas as pd
from datetime import datetime

st.set_page_config(page_title="Crypto Radar 1000SATS", layout="wide")

COINS = {
    "1000SATS": {"sym": "1000SATSUSDT", "prec": 8},
    "DOGE": {"sym": "DOGEUSDT", "prec": 5},
    "SHIB": {"sym": "SHIBUSDT", "prec": 8},
    "LUNC": {"sym": "LUNCUSDT", "prec": 7}
}

def get_data(symbol):
    url = f"https://api.binance.com/api/v3/klines?symbol={symbol}&interval=15m&limit=50"
    res = requests.get(url).json()
    return [{"h": float(k[2]), "l": float(k[3]), "c": float(k[4])} for k in res]

st.title("üöÄ 1000SATS Smart Radar Web")

cols = st.columns(4)

for i, (name, info) in enumerate(COINS.items()):
    data = get_data(info['sym'])
    price = data[-1]['c']
    ob_low = min([d['l'] for d in data[-20:]])
    ob_high = max([d['h'] for d in data[-20:]])
    
    with cols[i]:
        st.metric(name, f"{price:.{info['prec']}f}")
        if price <= ob_low * 1.002:
            st.success("–°–ò–ì–ù–ê–õ: LONG")
        elif price >= ob_high * 0.998:
            st.error("–°–ò–ì–ù–ê–õ: SHORT")
        else:
            st.info("–ü–û–ò–°–ö...")
        st.caption(f"L: {ob_low:.{info['prec']}f} | H: {ob_high:.{info['prec']}f}")
